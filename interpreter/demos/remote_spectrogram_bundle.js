/*! For license information please see remote_spectrogram_bundle.js.LICENSE.txt */
!function(){"use strict";var e={418:function(e){var t=Object.getOwnPropertySymbols,n=Object.prototype.hasOwnProperty,r=Object.prototype.propertyIsEnumerable;function o(e){if(null==e)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}e.exports=function(){try{if(!Object.assign)return!1;var e=new String("abc");if(e[5]="de","5"===Object.getOwnPropertyNames(e)[0])return!1;for(var t={},n=0;n<10;n++)t["_"+String.fromCharCode(n)]=n;if("0123456789"!==Object.getOwnPropertyNames(t).map((function(e){return t[e]})).join(""))return!1;var r={};return"abcdefghijklmnopqrst".split("").forEach((function(e){r[e]=e})),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},r)).join("")}catch(e){return!1}}()?Object.assign:function(e,a){for(var u,i,l=o(e),c=1;c<arguments.length;c++){for(var s in u=Object(arguments[c]))n.call(u,s)&&(l[s]=u[s]);if(t){i=t(u);for(var f=0;f<i.length;f++)r.call(u,i[f])&&(l[i[f]]=u[i[f]])}}return l}},408:function(e,t,n){var r=n(418),o=60103,a=60106;t.Fragment=60107,t.StrictMode=60108,t.Profiler=60114;var u=60109,i=60110,l=60112;t.Suspense=60113;var c=60115,s=60116;if("function"==typeof Symbol&&Symbol.for){var f=Symbol.for;o=f("react.element"),a=f("react.portal"),t.Fragment=f("react.fragment"),t.StrictMode=f("react.strict_mode"),t.Profiler=f("react.profiler"),u=f("react.provider"),i=f("react.context"),l=f("react.forward_ref"),t.Suspense=f("react.suspense"),c=f("react.memo"),s=f("react.lazy")}var d="function"==typeof Symbol&&Symbol.iterator;function p(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var m={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},g={};function y(e,t,n){this.props=e,this.context=t,this.refs=g,this.updater=n||m}function h(){}function v(e,t,n){this.props=e,this.context=t,this.refs=g,this.updater=n||m}y.prototype.isReactComponent={},y.prototype.setState=function(e,t){if("object"!=typeof e&&"function"!=typeof e&&null!=e)throw Error(p(85));this.updater.enqueueSetState(this,e,t,"setState")},y.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},h.prototype=y.prototype;var b=v.prototype=new h;b.constructor=v,r(b,y.prototype),b.isPureReactComponent=!0;var I={current:null},k=Object.prototype.hasOwnProperty,E={key:!0,ref:!0,__self:!0,__source:!0};function _(e,t,n){var r,a={},u=null,i=null;if(null!=t)for(r in void 0!==t.ref&&(i=t.ref),void 0!==t.key&&(u=""+t.key),t)k.call(t,r)&&!E.hasOwnProperty(r)&&(a[r]=t[r]);var l=arguments.length-2;if(1===l)a.children=n;else if(1<l){for(var c=Array(l),s=0;s<l;s++)c[s]=arguments[s+2];a.children=c}if(e&&e.defaultProps)for(r in l=e.defaultProps)void 0===a[r]&&(a[r]=l[r]);return{$$typeof:o,type:e,key:u,ref:i,props:a,_owner:I.current}}function C(e){return"object"==typeof e&&null!==e&&e.$$typeof===o}var w=/\/+/g;function O(e,t){return"object"==typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,(function(e){return t[e]}))}(""+e.key):t.toString(36)}function j(e,t,n,r,u){var i=typeof e;"undefined"!==i&&"boolean"!==i||(e=null);var l=!1;if(null===e)l=!0;else switch(i){case"string":case"number":l=!0;break;case"object":switch(e.$$typeof){case o:case a:l=!0}}if(l)return u=u(l=e),e=""===r?"."+O(l,0):r,Array.isArray(u)?(n="",null!=e&&(n=e.replace(w,"$&/")+"/"),j(u,t,n,"",(function(e){return e}))):null!=u&&(C(u)&&(u=function(e,t){return{$$typeof:o,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}(u,n+(!u.key||l&&l.key===u.key?"":(""+u.key).replace(w,"$&/")+"/")+e)),t.push(u)),1;if(l=0,r=""===r?".":r+":",Array.isArray(e))for(var c=0;c<e.length;c++){var s=r+O(i=e[c],c);l+=j(i,t,n,s,u)}else if("function"==typeof(s=function(e){return null===e||"object"!=typeof e?null:"function"==typeof(e=d&&e[d]||e["@@iterator"])?e:null}(e)))for(e=s.call(e),c=0;!(i=e.next()).done;)l+=j(i=i.value,t,n,s=r+O(i,c++),u);else if("object"===i)throw t=""+e,Error(p(31,"[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t));return l}function x(e,t,n){if(null==e)return e;var r=[],o=0;return j(e,r,"","",(function(e){return t.call(n,e,o++)})),r}function S(e){if(-1===e._status){var t=e._result;t=t(),e._status=0,e._result=t,t.then((function(t){0===e._status&&(t=t.default,e._status=1,e._result=t)}),(function(t){0===e._status&&(e._status=2,e._result=t)}))}if(1===e._status)return e._result;throw e._result}var $={current:null};function A(){var e=$.current;if(null===e)throw Error(p(321));return e}var P={ReactCurrentDispatcher:$,ReactCurrentBatchConfig:{transition:0},ReactCurrentOwner:I,IsSomeRendererActing:{current:!1},assign:r};t.Children={map:x,forEach:function(e,t,n){x(e,(function(){t.apply(this,arguments)}),n)},count:function(e){var t=0;return x(e,(function(){t++})),t},toArray:function(e){return x(e,(function(e){return e}))||[]},only:function(e){if(!C(e))throw Error(p(143));return e}},t.Component=y,t.PureComponent=v,t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=P,t.cloneElement=function(e,t,n){if(null==e)throw Error(p(267,e));var a=r({},e.props),u=e.key,i=e.ref,l=e._owner;if(null!=t){if(void 0!==t.ref&&(i=t.ref,l=I.current),void 0!==t.key&&(u=""+t.key),e.type&&e.type.defaultProps)var c=e.type.defaultProps;for(s in t)k.call(t,s)&&!E.hasOwnProperty(s)&&(a[s]=void 0===t[s]&&void 0!==c?c[s]:t[s])}var s=arguments.length-2;if(1===s)a.children=n;else if(1<s){c=Array(s);for(var f=0;f<s;f++)c[f]=arguments[f+2];a.children=c}return{$$typeof:o,type:e.type,key:u,ref:i,props:a,_owner:l}},t.createContext=function(e,t){return void 0===t&&(t=null),(e={$$typeof:i,_calculateChangedBits:t,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null}).Provider={$$typeof:u,_context:e},e.Consumer=e},t.createElement=_,t.createFactory=function(e){var t=_.bind(null,e);return t.type=e,t},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:l,render:e}},t.isValidElement=C,t.lazy=function(e){return{$$typeof:s,_payload:{_status:-1,_result:e},_init:S}},t.memo=function(e,t){return{$$typeof:c,type:e,compare:void 0===t?null:t}},t.useCallback=function(e,t){return A().useCallback(e,t)},t.useContext=function(e,t){return A().useContext(e,t)},t.useDebugValue=function(){},t.useEffect=function(e,t){return A().useEffect(e,t)},t.useImperativeHandle=function(e,t,n){return A().useImperativeHandle(e,t,n)},t.useLayoutEffect=function(e,t){return A().useLayoutEffect(e,t)},t.useMemo=function(e,t){return A().useMemo(e,t)},t.useReducer=function(e,t,n){return A().useReducer(e,t,n)},t.useRef=function(e){return A().useRef(e)},t.useState=function(e){return A().useState(e)},t.version="17.0.2"},294:function(e,t,n){e.exports=n(408)},517:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return o(t,e),t};Object.defineProperty(t,"__esModule",{value:!0});const u=a(n(294));let i=null,l=0,c=null,s=null,f=null,d=null,p=null,m=!1,g=null,y=0;function h(){let e=p.currentTime,t=f*e;i.panTo(t),y=t}function v(){clearInterval(g),m=!1}function b(){null==p||p.paused||(p.pause(),clearInterval(g)),m=!1}function I(e){m&&b(),p.currentTime=e/f,y=e}function k(e){switch(e.keyCode){case 32:e.target===document.body&&(m?b():null!=p&&(p.currentTime=y/f,i.panTo(y),p.onended=v,p.play(),g=setInterval(h,100),m=!0),e.preventDefault());break;case 39:y>=s||(m&&b(),y=Math.min(s,y+62.5),i.panTo(y));break;case 37:0!==y&&(m&&b(),y=Math.max(0,y-62.5),i.panTo(y))}}function E(e,t,n,r){if(0===e.length)return void alert("Error: No images?");let o=r.quickAccessCategoryIDs||[],a=r.annotationFilePrefix||"";var h={};function v(n){let r=e[n],a=h[r.id];null!=i&&(b(),document.removeEventListener("keydown",k),ReactDOM.unmountComponentAtNode(document.getElementById("annotationHolder")),i=null),$("#currentImageProgress").text("Image "+(n+1)+" / "+e.length),$("#currentAudioDuration").text("Dur: ? sec"),0===n?$("#previousImageButton").prop("disabled",!0):$("#previousImageButton").prop("disabled",!1),n===e.length-1?$("#nextImageButton").prop("disabled",!0):$("#nextImageButton").prop("disabled",!1);let l=new Image;l.onload=function(){function e(e){e.renderForSpectrogram(211),e.turnOffZoom(),e.turnOffDrag(),f=null,d=null,p=new Audio,m=!1,g=null,y=0,p.addEventListener("canplaythrough",(()=>{let e=p.duration;f=250,d=f/1e3,document.addEventListener("keydown",k),$("#currentAudioDuration").text("Dur: "+e.toFixed(2)+" sec")})),p.src=r.audio,p.addEventListener("error",(()=>{alert("Error loading the audio for image "+r.id+". Perhaps the resouce has been deleted? Maybe skip or try to come back to this asset?")})),p.load()}c=l.height,s=l.width;let n=u.createElement(document.LeafletAnnotation,{imageElement:l,image:r,annotations:a,categories:t,options:{enableEditingImmediately:!0,enableClassify:!1,map:{attributionControl:!1,zoomControl:!1,boxZoom:!1,doubleClickZoom:!1,keyboard:!1,scrollWheelZoom:!1},quickAccessCategoryIDs:o,newInstance:{annotateCategory:!0,annotateSupercategory:!1,annotationType:"box"},duplicateInstance:{enable:!0,duplicateY:!0},showCategory:!0,showSupercategory:!0,showIsCrowdCheckbox:!1,enableBoxEdit:!0,renderBoxes:!0,enableSegmentationEdit:!1,renderSegmentations:!1,imageInfoComponent:document.MLAudioInfo,didMountLeafletCallback:function(t){"audio"in r?setTimeout((()=>e(t)),100):console.log("No audio url in image info")},didFocusOnAnnotationCallback:I}},null);i=ReactDOM.render(n,document.getElementById("annotationHolder"));for(let e=0;e<5;e++)$(".leaflet-image-holder").append($("<span></span>").css({content:"",width:"1px",height:"100%",display:"block","z-index":999,left:120+240*e+"px",position:"absolute","background-image":"linear-gradient(#495057bf, #495057bf)","background-size":"1px 100%","background-repeat":"no-repeat","background-position":"center center"}))},l.addEventListener("error",(()=>{alert("Error loading the pixels for image "+r.id+". Perhaps the resouce has been deleted? Maybe skip?")})),l.src=r.url}function E(){if(null!=i){let t=i.getAnnotations({modifiedOnly:!1,excludeDeleted:!0}),n=e[l].id;h[n]=t}}function _(){E();let t=-1;try{t=parseInt($("#goToImageInput").val()),t-=1}catch(e){return}t>=0&&t<e.length&&(l=t,v(l))}e.forEach((e=>{h[e.id]=[]})),n.forEach((e=>{let t=e.image_id;h[t].push(e)})),$("#nextImageButton").click((function(){E(),l<e.length-1&&(l+=1,v(l)),document.getElementById("nextImageButton").blur()})),$("#previousImageButton").click((function(){E(),l>0&&(l-=1,v(l)),document.getElementById("previousImageButton").blur()})),$("#goToImageButton").click((function(){document.getElementById("goToImageButton").blur(),_()})),document.getElementById("goToImageInput").addEventListener("keyup",(({key:e})=>{"Enter"===e&&(document.getElementById("goToImageInput").blur(),_())})),$("#exportAnnos").click((function(){E();let t=[];e.forEach((e=>{t=t.concat(h[e.id])}));var n="data:text/json;charset=utf-8,"+encodeURIComponent(JSON.stringify(t)),r=document.createElement("a");r.setAttribute("href",n),r.setAttribute("download",a+"annotations.json"),document.body.appendChild(r),r.click(),r.remove(),alert("Exported a total of "+t.length+" annotations"),document.getElementById("exportAnnos").blur()})),document.addEventListener("mouseup",(e=>{document.activeElement&&"INPUT"!==e.target.tagName.toUpperCase()&&document.activeElement.blur()})),v(l)}document.querySelector("#customFile").addEventListener("change",(e=>{e.preventDefault();const t=[];let n=null,r=null,o=null,a=null;for(let u=0;u<e.target.files.length;u++){let i=e.target.files[u];if("image/jpeg"===i.type||"image/png"===i.type){let e=i.name.split(".")[0];t.push({id:e,url:i.webkitRelativePath,attribution:"N/A"})}else"application/json"===i.type?"images.json"===i.name?n=i.text().then((e=>JSON.parse(e))):"categories.json"===i.name?r=i.text().then((e=>JSON.parse(e))):i.name.includes("annotations.json")?o=i.text().then((e=>JSON.parse(e))):"config.json"==i.name?a=i.text().then((e=>JSON.parse(e))):console.log("Ignoring "+i.name+" (not sure what to do with it)."):console.log("Ignoring "+i.name+" (not sure what to do with it).")}Promise.all([n,r,o,a]).then((([e,n,r,o])=>{if(t.length>0&&null!=e)return void alert("ERROR: Found image files (jpgs/ pngs) and an images.json file. Not sure which to use! Please remove one or the other.");if(t.length>0&&(e=t).sort((function(e,t){const n=e.url.toUpperCase(),r=t.url.toUpperCase();return n<r?-1:n>r?1:0})),null==n)return void alert("Didn't find a category.json file. This needs to be created.");null==r&&(r=[]);const a={annotationFilePrefix:"",quickAccessCategoryIDs:function(){let e=$.trim(document.getElementById("easyAccessCategories").value);var t=[];if(""!==e){var n=e.split(/\r?\n/);t=document.getElementById("categoryIDTypeRadioStr").checked?n:n.map((e=>parseInt(e)))}return t}()};if(null!=o){let e=null;if("quickAccessCategoryIDs"in o&&o.quickAccessCategoryIDs.length>0&&a.quickAccessCategoryIDs.length>0){let t=a.quickAccessCategoryIDs,n=o.quickAccessCategoryIDs;e=t.concat(n.filter((e=>t.indexOf(e)<0)))}o=Object.assign({},a,o),null!=e&&(o.quickAccessCategoryIDs=e)}else o=a;document.getElementById("dirChooser").hidden=!0,document.getElementById("annotationTask").hidden=!1,E(e,n,r,o)}))}))}},t={};!function n(r){if(t[r])return t[r].exports;var o=t[r]={exports:{}};return e[r].call(o.exports,o,o.exports,n),o.exports}(517)}();